<nav class="navbar navbar-custom navbar-transparent navbar-fixed-top" role="navigation">

  <div class="container">

    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#custom-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <%= link_to 'BringMeACoffee', root_path, class: 'navbar-brand' %>
    </div> <!-- end navbar-header -->


    <div class="collapse navbar-collapse" id="custom-collapse">
      <div class="nav navbar-nav navbar-right">

      <% if user_signed_in? %>

        <!-- Logged Navbar -->


          <div style="display: flex">
            <!-- Calculate whether cart is empty or not -->
            <% sum = 0 %>
            <% unless (session[:carts].nil? || session[:carts].empty? || params[:id].nil?) %>
              <% session[:carts][params[:id]].each { |k, v| sum += v } %>
            <% end %>

            <% if sum.zero? %>
              <span id="icon-basket-status" class="icon-basket icon-navbar"></span>
            <% else %>
              <span id="icon-basket-status" class="icon-basket-loaded icon-navbar"></span>
            <% end %>
              <span id="cart-red-circle" class="cart-items cart-hidden">
                <%= sum %>
              </span>

            <div class="dropdown">
              <%= link_to '#', class: "dropdown", 'data-toggle' => "dropdown" do %>
                <% if current_user.photo? %>
                  <%= cl_image_tag current_user.photo.path, class: "avatar-large avatar-navbar-margin" %>
                <% else %>
                  <%= cl_image_tag ("Profile_avatar"), class: "avatar-large avatar-navbar-margin" %>
                <% end %>
              <% end %>

                <ul class="dropdown-menu" role="menu">
                  <li>
                    <%= link_to 'Profile', profile_path %>
                  </li>
                  <li>
                    <%= link_to "Log Out", destroy_user_session_path, method: :delete %>
                  </li>
                </ul>
            </div>
</div>


        <!-- end Logged Navbar -->

      <% else %>

        <!-- Home Navbar -->
        <ul class="nav navbar-nav navbar-right">

          <% if current_page?(root_path) %>
            <li class="page-scroll"><a href="#home">Home</a></li>
            <li class="page-scroll"><a href="#services">How it works</a></li>
            <li class="page-scroll"><a href="#gallery">Gallery</a></li>
          <% end %>
          <li class="page-scroll">
            <%= link_to 'Login', new_user_session_path, class: 'login-btn' %>
          </li>
        </ul>
        <!-- Home Navbar -->

      <% end %>

      </div>
    </div>

  </div><!-- .container -->

</nav>
